{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{NavLink,Outlet,useNavigate}from\"react-router-dom\";// Import useNavigate here\nimport{jwtDecode}from\"jwt-decode\";import\"./Layout.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Layout=()=>{const[userFirstName,setUserFirstName]=useState(null);const[userRole,setUserRole]=useState(null);const[isDropdownOpen,setDropdownOpen]=useState(false);const navigate=useNavigate();// Initialize navigate here\nconst toggleDropdown=()=>{setDropdownOpen(!isDropdownOpen);};const closeDropdown=e=>{if(!e.target.closest(\".profile\")){setDropdownOpen(false);}};useEffect(()=>{document.addEventListener(\"click\",closeDropdown);return()=>{document.removeEventListener(\"click\",closeDropdown);};},[]);useEffect(()=>{const token=localStorage.getItem(\"authToken\");if(token){try{const decodedToken=jwtDecode(token);setUserFirstName(decodedToken.firstname);setUserRole(decodedToken.role);}catch(error){console.error(\"Error decoding token:\",error);}}},[]);// Logout function\nconst logout=()=>{localStorage.removeItem(\"authToken\");// Remove token from localStorage\nsetUserFirstName(null);// Clear the user's first name\nnavigate(\"/login\");// Redirect to login page (or homepage if you prefer)\nsetTimeout(()=>{navigate(\"/login\");// Redirect to login page\n},100);// Delay to allow state to be cleared\n};// Function to update the user's first name\nconst updateFirstName=newFirstName=>{setUserFirstName(newFirstName);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"header\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:\"SaaS Template\"}),/*#__PURE__*/_jsx(\"nav\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile\",onClick:toggleDropdown,children:[/*#__PURE__*/_jsx(\"span\",{children:userFirstName}),/*#__PURE__*/_jsx(\"img\",{src:\"/images/profile_image.jpg\",alt:\"Profile\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown \".concat(isDropdownOpen?\"open\":\"\"),children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(NavLink,{to:\"/profile\",children:\"My Profile\"})}),userRole===\"admin\"&&/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(NavLink,{to:\"/adminportal\",children:\"Admin Portal\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(NavLink,{to:\"#\",onClick:logout,className:\"dropdown-item\",children:\"Logout\"})})]})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"aside\",{className:\"sidebar\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(NavLink,{to:\"/dashboard\",children:\"Dashboard\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(NavLink,{to:\"/analytics\",children:\"Analytics\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(NavLink,{to:\"/settings\",children:\"Settings\"})})]})}),/*#__PURE__*/_jsx(\"main\",{className:\"content\",children:/*#__PURE__*/_jsx(Outlet,{context:{updateFirstName}})})]})]});};export default Layout;","map":{"version":3,"names":["React","useState","useEffect","NavLink","Outlet","useNavigate","jwtDecode","jsx","_jsx","jsxs","_jsxs","Layout","userFirstName","setUserFirstName","userRole","setUserRole","isDropdownOpen","setDropdownOpen","navigate","toggleDropdown","closeDropdown","e","target","closest","document","addEventListener","removeEventListener","token","localStorage","getItem","decodedToken","firstname","role","error","console","logout","removeItem","setTimeout","updateFirstName","newFirstName","children","className","onClick","src","alt","concat","to","context"],"sources":["C:/Users/johnn/Documents/Noshly/frontend/src/components/Layout.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { NavLink, Outlet, useNavigate } from \"react-router-dom\";  // Import useNavigate here\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport \"./Layout.css\";\r\n\r\nconst Layout = () => {\r\n  const [userFirstName, setUserFirstName] = useState(null);\r\n  const [userRole, setUserRole] = useState(null);\r\n  const [isDropdownOpen, setDropdownOpen] = useState(false);\r\n  const navigate = useNavigate();  // Initialize navigate here\r\n\r\n  const toggleDropdown = () => {\r\n    setDropdownOpen(!isDropdownOpen);\r\n  };\r\n\r\n  const closeDropdown = (e) => {\r\n    if (!e.target.closest(\".profile\")) {\r\n      setDropdownOpen(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"click\", closeDropdown);\r\n    return () => {\r\n      document.removeEventListener(\"click\", closeDropdown);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"authToken\");\r\n\r\n    if (token) {\r\n      try {\r\n        const decodedToken = jwtDecode(token);\r\n        setUserFirstName(decodedToken.firstname);\r\n        setUserRole(decodedToken.role);\r\n      } catch (error) {\r\n        console.error(\"Error decoding token:\", error);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Logout function\r\n  const logout = () => {\r\n    localStorage.removeItem(\"authToken\"); // Remove token from localStorage\r\n    setUserFirstName(null); // Clear the user's first name\r\n    navigate(\"/login\"); // Redirect to login page (or homepage if you prefer)\r\n     setTimeout(() => {\r\n      navigate(\"/login\"); // Redirect to login page\r\n    }, 100); // Delay to allow state to be cleared\r\n  };\r\n\r\n  // Function to update the user's first name\r\n  const updateFirstName = (newFirstName) => {\r\n    setUserFirstName(newFirstName);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <header className=\"header\">\r\n        <div className=\"logo\">SaaS Template</div>\r\n        <nav>\r\n          <div className=\"profile\" onClick={toggleDropdown}>\r\n            <span>{userFirstName}</span>\r\n            <img\r\n              src=\"/images/profile_image.jpg\"\r\n              alt=\"Profile\"\r\n            />\r\n            <div className={`dropdown ${isDropdownOpen ? \"open\" : \"\"}`}>\r\n              <ul>\r\n                <li><NavLink to=\"/profile\">My Profile</NavLink></li>\r\n                {userRole === \"admin\" && (<li><NavLink to=\"/adminportal\">Admin Portal</NavLink></li>)}\r\n                <li><NavLink to=\"#\" onClick={logout} className=\"dropdown-item\">Logout</NavLink></li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </nav>\r\n      </header>\r\n      <div className=\"container\">\r\n        <aside className=\"sidebar\">\r\n          <ul>\r\n            <li><NavLink to=\"/dashboard\">Dashboard</NavLink></li>\r\n            <li><NavLink to=\"/analytics\">Analytics</NavLink></li>\r\n            <li><NavLink to=\"/settings\">Settings</NavLink></li>\r\n          </ul>\r\n        </aside>\r\n        <main className=\"content\">\r\n          <Outlet context={{ updateFirstName }}/>\r\n        </main>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Layout;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}